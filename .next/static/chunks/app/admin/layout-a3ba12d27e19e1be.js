(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{2425:function(e,s,t){Promise.resolve().then(t.bind(t,9803))},9803:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return AdminLayout}});var n=t(7821),i=t(8078),l=t(6179),r=t(6871),o=t.n(r),a=t(1910);function AdminLayout(e){let{children:s}=e,t=(0,l.useRouter)(),[r,c]=(0,i.useState)(!1),[d,m]=(0,i.useState)(!0);(0,i.useEffect)(()=>{checkAdminAuth()},[]);let checkAdminAuth=async()=>{try{console.log("=== Admin Auth Check Started ===");let{data:{user:e}}=await a.O.auth.getUser();if(!e){console.log("❌ No user found, redirecting to login"),t.push("/login");return}console.log("✅ User found:",{id:e.id,email:e.email});let{data:s,error:n}=await a.O.from("user_profiles").select("role, email").eq("id",e.id).single();if(console.log("\uD83D\uDCCA Profile query result:",{profile:s,error:n}),n){if(console.log("❌ Error fetching profile:",n.message),["admin@aiskool.com","admin@example.com","coconut31@naver.com"].includes(e.email||"")){console.log("✅ Admin access granted by email fallback"),c(!0);return}t.push("/");return}(null==s?void 0:s.role)==="admin"?(console.log("✅ Admin access granted by role"),c(!0)):(console.log("❌ User is not admin. Role:",null==s?void 0:s.role),t.push("/"))}catch(e){console.error("❌ Unexpected error:",e),t.push("/")}finally{m(!1),console.log("=== Admin Auth Check Completed ===")}};return d?(0,n.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-white",children:"Loading..."})}):r?(0,n.jsxs)("div",{className:"min-h-screen bg-black",children:[(0,n.jsx)("nav",{className:"bg-gray-900 border-b border-gray-800",children:(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,n.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(o(),{href:"/admin",className:"text-emerald-400 font-bold text-xl",children:"AIskool! Admin"}),(0,n.jsxs)("div",{className:"ml-10 flex items-baseline space-x-4",children:[(0,n.jsx)(o(),{href:"/admin",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium",children:"대시보드"}),(0,n.jsx)(o(),{href:"/admin/courses",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium",children:"강의 관리"}),(0,n.jsx)(o(),{href:"/admin/news",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium",children:"뉴스 관리"}),(0,n.jsx)(o(),{href:"/admin/users",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium",children:"사용자 관리"})]})]}),(0,n.jsx)("div",{children:(0,n.jsx)("button",{onClick:()=>{a.O.auth.signOut(),t.push("/")},className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium",children:"로그아웃"})})]})})}),(0,n.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s})]}):null}},1910:function(e,s,t){"use strict";t.d(s,{O:function(){return r}});var n=t(4744);let i="https://pgtsxojnziyfkgghzmib.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBndHN4b2pueml5ZmtnZ2h6bWliIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA0MDEwMjMsImV4cCI6MjA2NTk3NzAyM30.BP9rHr3lfNhMCYPLulyj3ia2z8Q9sbsc1xqS1mjVJ8g",r=i&&l?(0,n.eI)(i,l):null},6179:function(e,s,t){e.exports=t(5353)}},function(e){e.O(0,[144,871,115,835,744],function(){return e(e.s=2425)}),_N_E=e.O()}]);