(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[14],{6406:function(e,r,t){Promise.resolve().then(t.bind(t,9215))},9215:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return NewCoursePage}});var s=t(7821),i=t(8078),l=t(6179),n=t(6871),o=t.n(n),a=t(1910);function NewCoursePage(){let e=(0,l.useRouter)(),[r,t]=(0,i.useState)(!1),[n,u]=(0,i.useState)({title:"",description:"",category:"프로그래밍",level:"입문",duration:"",price:0,instructor:"",thumbnail:"",objectives:[""],requirements:[""],curriculum:[{id:"1",title:"",lessons:[{id:"1-1",title:"",duration:"",preview:!1}]}]}),handleSubmit=async r=>{r.preventDefault(),t(!0);try{let{data:r,error:t}=await a.O.from("courses").insert({title:n.title,description:n.description,category:n.category,level:n.level,duration:n.duration,price:n.price,instructor:n.instructor,thumbnail:n.thumbnail,lessons_count:n.curriculum.reduce((e,r)=>e+r.lessons.length,0),students_count:0,rating:0}).select().single();if(t){console.error("강의 생성 실패:",t),alert("강의 생성에 실패했습니다: "+t.message);return}if(console.log("강의 생성 성공:",r),n.objectives.filter(e=>e.trim()).length>0){let e=n.objectives.filter(e=>e.trim()).map((e,t)=>({course_id:r.id,objective:e.trim(),order_index:t+1})),{error:t}=await a.O.from("course_objectives").insert(e);t&&console.error("학습 목표 삽입 실패:",t)}if(n.requirements.filter(e=>e.trim()).length>0){let e=n.requirements.filter(e=>e.trim()).map((e,t)=>({course_id:r.id,requirement:e.trim(),order_index:t+1})),{error:t}=await a.O.from("course_requirements").insert(e);t&&console.error("수강 요구사항 삽입 실패:",t)}for(let e=0;e<n.curriculum.length;e++){let t=n.curriculum[e];if(!t.title.trim())continue;let{data:s,error:i}=await a.O.from("course_sections").insert({course_id:r.id,title:t.title.trim(),order_index:e+1}).select().single();if(i){console.error("섹션 삽입 실패:",i);continue}let l=t.lessons.filter(e=>e.title.trim());if(l.length>0){let e=l.map((e,r)=>({section_id:s.id,title:e.title.trim(),duration:e.duration||"0:00",preview:e.preview,order_index:r+1})),{error:r}=await a.O.from("course_lessons").insert(e);r&&console.error("레슨 삽입 실패:",r)}}alert("강의가 성공적으로 등록되었습니다!"),e.push("/admin/courses")}catch(e){console.error("예상치 못한 오류:",e),alert("강의 등록 중 오류가 발생했습니다.")}finally{t(!1)}},removeObjective=e=>{u({...n,objectives:n.objectives.filter((r,t)=>t!==e)})},updateObjective=(e,r)=>{let t=[...n.objectives];t[e]=r,u({...n,objectives:t})},removeRequirement=e=>{u({...n,requirements:n.requirements.filter((r,t)=>t!==e)})},updateRequirement=(e,r)=>{let t=[...n.requirements];t[e]=r,u({...n,requirements:t})},removeSection=e=>{u({...n,curriculum:n.curriculum.filter((r,t)=>t!==e)})},updateSectionTitle=(e,r)=>{let t=[...n.curriculum];t[e].title=r,u({...n,curriculum:t})},addLesson=e=>{let r=[...n.curriculum],t=r[e],s="".concat(t.id,"-").concat(t.lessons.length+1);t.lessons.push({id:s,title:"",duration:"",preview:!1}),u({...n,curriculum:r})},removeLesson=(e,r)=>{let t=[...n.curriculum];t[e].lessons=t[e].lessons.filter((e,t)=>t!==r),u({...n,curriculum:t})},updateLesson=(e,r,t,s)=>{let i=[...n.curriculum];i[e].lessons[r]={...i[e].lessons[r],[t]:s},u({...n,curriculum:i})};return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-white",children:"새 강의 등록"}),(0,s.jsx)(o(),{href:"/admin/courses",className:"text-gray-300 hover:text-white",children:"← 목록으로 돌아가기"})]}),(0,s.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-8",children:[(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white mb-6",children:"기본 정보"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"강의명 *"}),(0,s.jsx)("input",{type:"text",required:!0,value:n.title,onChange:e=>u({...n,title:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"강사명 *"}),(0,s.jsx)("input",{type:"text",required:!0,value:n.instructor,onChange:e=>u({...n,instructor:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"카테고리 *"}),(0,s.jsx)("select",{required:!0,value:n.category,onChange:e=>u({...n,category:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500",children:["프로그래밍","AI/ML","데이터분석","웹개발","모바일","보안"].map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"난이도 *"}),(0,s.jsx)("select",{required:!0,value:n.level,onChange:e=>u({...n,level:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500",children:["입문","초급","중급","고급"].map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"수강 기간"}),(0,s.jsx)("input",{type:"text",placeholder:"예: 8주",value:n.duration,onChange:e=>u({...n,duration:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"가격 (원) *"}),(0,s.jsx)("input",{type:"number",required:!0,min:"0",value:n.price,onChange:e=>u({...n,price:parseInt(e.target.value)||0}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"})]})]}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"강의 설명 *"}),(0,s.jsx)("textarea",{required:!0,rows:4,value:n.description,onChange:e=>u({...n,description:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"썸네일 URL"}),(0,s.jsx)("input",{type:"url",value:n.thumbnail,onChange:e=>u({...n,thumbnail:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"})]})]}),(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white mb-6",children:"학습 목표"}),n.objectives.map((e,r)=>(0,s.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,s.jsx)("input",{type:"text",value:e,onChange:e=>updateObjective(r,e.target.value),placeholder:"학습 목표를 입력하세요",className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"}),n.objectives.length>1&&(0,s.jsx)("button",{type:"button",onClick:()=>removeObjective(r),className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md",children:"삭제"})]},r)),(0,s.jsx)("button",{type:"button",onClick:()=>{u({...n,objectives:[...n.objectives,""]})},className:"mt-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-md",children:"목표 추가"})]}),(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white mb-6",children:"수강 요구사항"}),n.requirements.map((e,r)=>(0,s.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,s.jsx)("input",{type:"text",value:e,onChange:e=>updateRequirement(r,e.target.value),placeholder:"수강 요구사항을 입력하세요",className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"}),n.requirements.length>1&&(0,s.jsx)("button",{type:"button",onClick:()=>removeRequirement(r),className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md",children:"삭제"})]},r)),(0,s.jsx)("button",{type:"button",onClick:()=>{u({...n,requirements:[...n.requirements,""]})},className:"mt-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-md",children:"요구사항 추가"})]}),(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white mb-6",children:"커리큘럼"}),n.curriculum.map((e,r)=>(0,s.jsxs)("div",{className:"mb-6 p-4 bg-gray-800 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,s.jsx)("input",{type:"text",value:e.title,onChange:e=>updateSectionTitle(r,e.target.value),placeholder:"섹션 제목을 입력하세요",className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"}),n.curriculum.length>1&&(0,s.jsx)("button",{type:"button",onClick:()=>removeSection(r),className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md",children:"섹션 삭제"})]}),e.lessons.map((t,i)=>(0,s.jsxs)("div",{className:"flex gap-2 mb-2 ml-4",children:[(0,s.jsx)("input",{type:"text",value:t.title,onChange:e=>updateLesson(r,i,"title",e.target.value),placeholder:"강의 제목",className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"}),(0,s.jsx)("input",{type:"text",value:t.duration,onChange:e=>updateLesson(r,i,"duration",e.target.value),placeholder:"시간 (예: 15:00)",className:"w-24 px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-emerald-500"}),(0,s.jsxs)("label",{className:"flex items-center text-white",children:[(0,s.jsx)("input",{type:"checkbox",checked:t.preview,onChange:e=>updateLesson(r,i,"preview",e.target.checked),className:"mr-2"}),"미리보기"]}),e.lessons.length>1&&(0,s.jsx)("button",{type:"button",onClick:()=>removeLesson(r,i),className:"px-2 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md text-sm",children:"삭제"})]},t.id)),(0,s.jsx)("button",{type:"button",onClick:()=>addLesson(r),className:"mt-2 ml-4 px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm",children:"강의 추가"})]},e.id)),(0,s.jsx)("button",{type:"button",onClick:()=>{let e=(n.curriculum.length+1).toString();u({...n,curriculum:[...n.curriculum,{id:e,title:"",lessons:[{id:"".concat(e,"-1"),title:"",duration:"",preview:!1}]}]})},className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-md",children:"섹션 추가"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,s.jsx)(o(),{href:"/admin/courses",className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"취소"}),(0,s.jsx)("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:r?"등록 중...":"강의 등록"})]})]})]})}},1910:function(e,r,t){"use strict";t.d(r,{O:function(){return n}});var s=t(4744);let i="https://pgtsxojnziyfkgghzmib.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBndHN4b2pueml5ZmtnZ2h6bWliIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA0MDEwMjMsImV4cCI6MjA2NTk3NzAyM30.BP9rHr3lfNhMCYPLulyj3ia2z8Q9sbsc1xqS1mjVJ8g",n=i&&l?(0,s.eI)(i,l):null},6179:function(e,r,t){e.exports=t(5353)}},function(e){e.O(0,[144,871,115,835,744],function(){return e(e.s=6406)}),_N_E=e.O()}]);