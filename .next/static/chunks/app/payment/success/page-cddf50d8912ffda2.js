(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[478],{2155:function(e,t,r){"use strict";var n,s;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(s=r.g.process)?void 0:s.env)?r.g.process:r(1984)},2795:function(e,t,r){Promise.resolve().then(r.bind(r,8524))},8524:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return PaymentSuccessPage}});var n=r(7821),s=r(8078),a=r(6179),i=r(4048),c=r(6871),o=r.n(c),l=r(3059);function PaymentSuccessPage(){let e=(0,a.useSearchParams)();(0,a.useRouter)();let[t,r]=(0,s.useState)(!0),[c,u]=(0,s.useState)(null),[d,m]=(0,s.useState)(null),h=e.get("orderId");(0,s.useEffect)(()=>{h?verifyPayment():(m("주문번호가 없습니다."),r(!1))},[h]);let verifyPayment=async()=>{try{let e=await (0,l.WW)(h);e.success?u(e.data):m(e.message||"결제 확인에 실패했습니다.")}catch(e){console.error("결제 확인 오류:",e),m("결제 상태 확인 중 오류가 발생했습니다.")}finally{r(!1)}};return t?(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)(i.default,{}),(0,n.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"결제 확인 중..."})]})})]}):(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)(i.default,{}),(0,n.jsx)("div",{className:"pt-20 pb-12",children:(0,n.jsx)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:d?(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[(0,n.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"결제 확인 실패"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:d}),(0,n.jsxs)("div",{className:"space-x-4",children:[(0,n.jsx)(o(),{href:"/courses",className:"inline-flex items-center px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-md transition-colors",children:"강의 목록으로"}),(0,n.jsx)(o(),{href:"/dashboard",className:"inline-flex items-center px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-md transition-colors",children:"대시보드로"})]})]}):(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[(0,n.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-emerald-100 rounded-full flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-8 h-8 text-emerald-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"결제가 완료되었습니다!"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"강의 수강이 정상적으로 등록되었습니다."}),c&&(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 mb-6 text-left",children:[(0,n.jsx)("h2",{className:"font-semibold text-gray-900 mb-4",children:"결제 정보"}),(0,n.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-gray-600",children:"주문번호:"}),(0,n.jsx)("span",{className:"font-medium",children:h})]}),c.courseName&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-gray-600",children:"강의명:"}),(0,n.jsx)("span",{className:"font-medium",children:c.courseName})]}),c.amount&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-gray-600",children:"결제금액:"}),(0,n.jsxs)("span",{className:"font-medium",children:["₩",c.amount.toLocaleString()]})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-gray-600",children:"결제일시:"}),(0,n.jsx)("span",{className:"font-medium",children:new Date().toLocaleString()})]})]})]}),(0,n.jsxs)("div",{className:"space-x-4",children:[(0,n.jsx)(o(),{href:"/dashboard",className:"inline-flex items-center px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-md transition-colors",children:"내 강의 보기"}),(0,n.jsx)(o(),{href:"/courses",className:"inline-flex items-center px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-md transition-colors",children:"다른 강의 보기"})]})]})})})]})}},4048:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Header}});var n=r(7821),s=r(6871),a=r.n(s),i=r(8078),c=r(1910),o=r(6179);function Header(){let[e,t]=(0,i.useState)(null),r=(0,o.useRouter)();(0,i.useEffect)(()=>{let checkUser=async()=>{let{data:{user:e}}=await c.O.auth.getUser();t(e)};checkUser();let{data:{subscription:e}}=c.O.auth.onAuthStateChange((e,r)=>{var n;t(null!==(n=null==r?void 0:r.user)&&void 0!==n?n:null)});return()=>e.unsubscribe()},[]);let handleLogout=async()=>{await c.O.auth.signOut(),r.push("/")};return(0,n.jsx)("nav",{className:"fixed top-0 w-full z-50 bg-white/80 backdrop-blur-md border-b border-gray-200",children:(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,n.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(a(),{href:"/",children:(0,n.jsx)("img",{src:"/logo7.png",alt:"SKOOL",className:"h-14 w-auto cursor-pointer"})})}),(0,n.jsx)("div",{className:"flex items-center space-x-4",children:e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a(),{href:"/dashboard",className:"text-gray-600 hover:text-navy-900 px-3 py-2 text-sm font-medium",children:"나의 강의실"}),(0,n.jsx)("button",{onClick:handleLogout,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"로그아웃"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a(),{href:"/login",className:"text-gray-600 hover:text-navy-900 px-3 py-2 text-sm font-medium",children:"로그인"}),(0,n.jsx)(a(),{href:"/login",className:"bg-emerald-500 hover:bg-emerald-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"시작하기"})]})})]})})})}},3059:function(e,t,r){"use strict";r.d(t,{WW:function(){return checkPaymentStatus},kR:function(){return requestPaymentLink}}),r(2155);let requestPaymentLink=async e=>{try{let t=generateOrderId(e.courseId,e.userId),r=await fetch("/api/payment/payple/create-link",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payType:"card",payWork:"PAYMENT",payGoods:e.courseName,payTotal:e.amount,payOid:t,payerName:e.customerName,payerEmail:e.customerEmail,payerHp:e.customerPhone||"",linkExpiredDate:getExpiredDate(),returnUrl:"".concat(window.location.origin,"/payment/success?orderId=").concat(t),cancelUrl:"".concat(window.location.origin,"/payment/cancel?orderId=").concat(t),webhookUrl:"".concat(window.location.origin,"/api/payment/payple/webhook")})}),n=await r.json();if(n.success&&n.paymentUrl)return{success:!0,paymentUrl:n.paymentUrl,paymentId:t,data:n};return{success:!1,message:n.message||"결제 링크 생성에 실패했습니다."}}catch(e){return console.error("결제 링크 생성 오류:",e),{success:!1,message:"결제 시스템 오류가 발생했습니다."}}},generateOrderId=(e,t)=>{let r=Date.now();return"ORDER_".concat(e,"_").concat(t,"_").concat(r)},getExpiredDate=()=>{let e=new Date;return e.setHours(e.getHours()+24),e.toISOString().slice(0,19).replace("T"," ")},checkPaymentStatus=async e=>{try{let t=await fetch("/api/payment/payple/status?orderId=".concat(e)),r=await t.json();return r}catch(e){return console.error("결제 상태 확인 오류:",e),{success:!1,message:"결제 상태 확인 중 오류가 발생했습니다."}}}},1910:function(e,t,r){"use strict";r.d(t,{O:function(){return i}});var n=r(4744);let s="https://pgtsxojnziyfkgghzmib.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBndHN4b2pueml5ZmtnZ2h6bWliIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA0MDEwMjMsImV4cCI6MjA2NTk3NzAyM30.BP9rHr3lfNhMCYPLulyj3ia2z8Q9sbsc1xqS1mjVJ8g",i=s&&a?(0,n.eI)(s,a):null},1984:function(e){!function(){var t={229:function(e){var t,r,n,s=e.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(e){if(t===setTimeout)return setTimeout(e,0);if((t===defaultSetTimout||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}function runClearTimeout(e){if(r===clearTimeout)return clearTimeout(e);if((r===defaultClearTimeout||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){t=defaultSetTimout}try{r="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){r=defaultClearTimeout}}();var a=[],i=!1,c=-1;function cleanUpNextTick(){i&&n&&(i=!1,n.length?a=n.concat(a):c=-1,a.length&&drainQueue())}function drainQueue(){if(!i){var e=runTimeout(cleanUpNextTick);i=!0;for(var t=a.length;t;){for(n=a,a=[];++c<t;)n&&n[c].run();c=-1,t=a.length}n=null,i=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];a.push(new Item(e,t)),1!==a.length||i||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=noop,s.addListener=noop,s.once=noop,s.off=noop,s.removeListener=noop,s.removeAllListeners=noop,s.emit=noop,s.prependListener=noop,s.prependOnceListener=noop,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},r={};function __nccwpck_require__(e){var n=r[e];if(void 0!==n)return n.exports;var s=r[e]={exports:{}},a=!0;try{t[e](s,s.exports,__nccwpck_require__),a=!1}finally{a&&delete r[e]}return s.exports}__nccwpck_require__.ab="//";var n=__nccwpck_require__(229);e.exports=n}()},6179:function(e,t,r){e.exports=r(5353)}},function(e){e.O(0,[144,871,115,835,744],function(){return e(e.s=2795)}),_N_E=e.O()}]);